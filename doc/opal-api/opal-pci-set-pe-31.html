<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>OPAL_PCI_SET_PE &mdash; skiboot 5.4.0-prerelease-development-snapshot documentation</title>
    
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '5.4.0-prerelease-development-snapshot',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="skiboot 5.4.0-prerelease-development-snapshot documentation" href="../index.html" />
    <link rel="up" title="OPAL API Documentation" href="index.html" />
    <link rel="next" title="OPAL_PCI_SET_PELTV" href="opal-pci-set-peltv-32.html" />
    <link rel="prev" title="OPAL_PCI_SET_MVE_ENABLE" href="opal-pci-set-mve-enable-34.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="opal-pci-set-peltv-32.html" title="OPAL_PCI_SET_PELTV"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="opal-pci-set-mve-enable-34.html" title="OPAL_PCI_SET_MVE_ENABLE"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">skiboot 5.4.0-prerelease-development-snapshot documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="index.html" accesskey="U">OPAL API Documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="opal-pci-set-pe">
<h1>OPAL_PCI_SET_PE<a class="headerlink" href="#opal-pci-set-pe" title="Permalink to this headline">Â¶</a></h1>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1">#define OPAL_PCI_SET_PE                              31</span>
</pre></div>
</div>
<p><strong>NOTE:</strong> The following two paragraphs come from some old documentation and
have not been checked for accuracy. Same goes for bus_compare, dev_compare
and func_compare documentation. Do <em>NOT</em> assume this documentation is correct
without checking the source.</p>
<p>A host OS calls this function to map a PCIE function (RID), or range of
function bus/dev/funcs (RIDs), to a PHB PE. The bus, device, func, and
compare parameters define a range of bus, device, or function numbers to
define a range of RIDs within this domain. A value of &#8220;7&#8221; for the bus_compare,
and non-zero for the dev_compare and func_compare, define exactly one function
RID to be a PE (within a PE number domain).</p>
<p>This must be called prior to ALL other OPAL calls that take a PE number
argument, for OPAL to correlate the RID (bus/dev/func) domain of the PE. If a
PE domain is changed, the host must call this to reset the PE bus/dev/func
domain and then call all other OPAL calls that map PHB IODA resources to
update those domains within PHB facilities.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">static</span> <span class="n">int64_t</span> <span class="n">opal_pci_set_pe</span><span class="p">(</span><span class="n">uint64_t</span> <span class="n">phb_id</span><span class="p">,</span> <span class="n">uint64_t</span> <span class="n">pe_number</span><span class="p">,</span>
                            <span class="n">uint64_t</span> <span class="n">bus_dev_func</span><span class="p">,</span> <span class="n">uint8_t</span> <span class="n">bus_compare</span><span class="p">,</span>
                            <span class="n">uint8_t</span> <span class="n">dev_compare</span><span class="p">,</span> <span class="n">uint8_t</span> <span class="n">func_compare</span><span class="p">,</span>
                            <span class="n">uint8_t</span> <span class="n">pe_action</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">phb_id</span></code></dt>
<dd>is the value from the PHB node ibm,opal-phbid property.</dd>
<dt><code class="docutils literal"><span class="pre">pe_number</span></code></dt>
<dd>is the index of a PE, from 0 to ibm,opal-num-pes minus 1.</dd>
<dt><code class="docutils literal"><span class="pre">bus_compare</span></code></dt>
<dd><p class="first">is a value from 0 to 7 indicating which bus number
bits define the range of buses in a PE domain:</p>
<p>0 = do not validate against RID bus number (PE = all bus numbers)</p>
<dl class="docutils">
<dt>2 = compare high order 3 bits of RID bus number to high order 3 bits of</dt>
<dd>PE bus number</dd>
<dt>3 = compare high order 4 bits of RID bus number to high order 4 bits of</dt>
<dd>PE bus number</dd>
<dt>6 = compare high order 7 bits of RID bus number to high order 7 bits of</dt>
<dd>PE bus number</dd>
</dl>
<p class="last">7 = compare all bits of RID bus number to all bits of PE bus number</p>
</dd>
<dt><code class="docutils literal"><span class="pre">dev_compare</span></code></dt>
<dd>indicates to compare the RID device number to the PE
device number or not. &#8216;0&#8217; signifies that the RID device number is not compared
&#8211; essentially all device numbers within the bus and function number range of
this PE are also within this PE. Non-zero signifies to compare the RID device
number to the PE device number, such that only that device number is in the PE
domain, for all buses and function numbers in the PE domain.</dd>
<dt><code class="docutils literal"><span class="pre">func_compare</span></code></dt>
<dd>indicates to compare the RID function number to the
PE function number or not. &#8216;0&#8217; signifies that the RID function number is not
compared &#8211; essentially all function numbers within the bus and device number
range of this PE are also within this PE. Non-zero signifies to compare the
RID function number to the PE function number, such that only that function
number is in the PE domain, for all buses and device numbers in the PE domain.</dd>
<dt><code class="docutils literal"><span class="pre">pe_action</span></code></dt>
<dd><p class="first">is one of:</p>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="n">enum</span> <span class="n">OpalPeAction</span> <span class="p">{</span>
    <span class="n">OPAL_UNMAP_PE</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">OPAL_MAP_PE</span> <span class="o">=</span> <span class="mi">1</span>
<span class="p">};</span>
</pre></div>
</div>
</dd>
</dl>
<p>Return value:</p>
<dl class="docutils">
<dt>OPAL_PARAMETER</dt>
<dd>If one of the following:
- invalid phb
- invalid pe_action
- invalid bus_dev_func
- invalid bus_compare</dd>
<dt>OPAL_UNSUPPORTED</dt>
<dd>PHB does not support set_pe operation</dd>
<dt>OPAL_SUCCESS</dt>
<dd>if opreation was successful</dd>
</dl>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="opal-pci-set-mve-enable-34.html"
                        title="previous chapter">OPAL_PCI_SET_MVE_ENABLE</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="opal-pci-set-peltv-32.html"
                        title="next chapter">OPAL_PCI_SET_PELTV</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/opal-api/opal-pci-set-pe-31.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="opal-pci-set-peltv-32.html" title="OPAL_PCI_SET_PELTV"
             >next</a> |</li>
        <li class="right" >
          <a href="opal-pci-set-mve-enable-34.html" title="OPAL_PCI_SET_MVE_ENABLE"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">skiboot 5.4.0-prerelease-development-snapshot documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="index.html" >OPAL API Documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2016, Stewart Smith, IBM, others.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.5.
    </div>
  </body>
</html>